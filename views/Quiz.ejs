<!-- quiz.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>
    <h1>Quiz App</h1>
    <h2>Topic: <%= selected_option %></h2>

    <!-- Debugging: Display selected_option and quiz_data -->
    <div>Selected Option: <%= JSON.stringify(selected_option) %></div>
    <div>Quiz Data: <%= JSON.stringify(quiz_data) %></div>

    <!-- Iterate through each question -->
    <% for (let questionNumber in quiz_data) { %>
        <h3>Question <%= questionNumber.replace('question', '') %>: <%= quiz_data[questionNumber].query %></h3>

        <!-- Display options for the current question -->
        <ul>
            <% for (let option in quiz_data[questionNumber].options) { %>
                <li>
                    <%= quiz_data[questionNumber].options[option] %>
                </li>
            <% } %>
        </ul>
    <% } %>

    <!-- Submit button -->
    <button id="submitButton">Submit Quiz</button>

    <!-- JavaScript code to handle quiz submission -->
    <script>
        const quizData = JSON.parse(JSON.stringify(quiz_data));

        document.addEventListener('DOMContentLoaded', function() {
            const submitButton = document.querySelector('#submitButton');

            submitButton.addEventListener('click', function(event) {
                event.preventDefault();

                // Get selected options
                const selectedOptions = [];
                for (let questionNumber in quizData) {
                    const selectedOption = document.querySelector(`input[name="question_${questionNumber}"]:checked`);
                    if (!selectedOption) {
                        alert('Please answer all questions.');
                        return;
                    }
                    selectedOptions.push(selectedOption.value);
                }

                // Evaluate selected options against correct answers
                let score = 0;
                for (let questionNumber in quizData) {
                    const correctAnswer = quizData[questionNumber].answer;
                    if (selectedOptions.includes(correctAnswer)) {
                        score++;
                    }
                }

                // Display score to the user
                alert(`Your score: ${score} out of ${Object.keys(quizData).length}`);
            });
        });
    </script>
</body>
</html>